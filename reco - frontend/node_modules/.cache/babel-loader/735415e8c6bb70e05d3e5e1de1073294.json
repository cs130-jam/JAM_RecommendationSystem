{"ast":null,"code":"var _jsxFileName = \"/Users/soniajaiswal/IdeaProjects/JAM/jam-frontend/src/components/signup.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport '../App.css';\nimport InputField from '../util/inputField';\nimport useInterval from '../util/useInterval';\nimport ErrorInputField from '../util/errorInputField';\nimport DropdownField from '../util/dropdownField';\nimport { Alert } from 'react-bootstrap';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CHECK_USERNAME_DELAY = 2000; // every 2 seconds\n\nconst ARTIST_SEARCH_DELAY = 1000; // every second\n\nconst MIN_ARTIST_SEARCH_LEN = 2;\n\nfunction matchingPrefixIgnoreCase(prefix, entries) {\n  prefix = prefix.toLowerCase();\n  return entries.filter(entry => {\n    const compareLength = Math.min(prefix.length, entry.length);\n    return prefix.substring(0, compareLength) === entry.substring(0, compareLength).toLowerCase();\n  });\n}\n\nconst instrumentsListStyle = {\n  margin: \"0px\",\n  padding: \"0px\",\n  listStyleType: \"none\"\n};\nconst artistContainer = {\n  height: \"60px\",\n  position: \"relative\"\n};\nconst artistImageStyle = {\n  width: \"60px\",\n  height: \"60px\",\n  borderRadius: \"3px\"\n};\nconst artistNameStyle = {\n  fontSize: \"18pt\",\n  position: \"absolute\",\n  top: \"15px\",\n  left: \"70px\"\n};\nconst artistButtonStyle = {\n  marginTop: \"18px\",\n  marginRight: \"-10px\"\n};\nconst alertStyle = {\n  top: '0'\n};\n\nconst SignUp = props => {\n  _s();\n\n  const setSessionToken = props.setSessionToken;\n  const apiService = props.apiService;\n  const [isValidInterests, setIsValidInterests] = useState(true);\n  const [failMessage, setFailMessage] = useState(\"\");\n  const [isValidUsername, setIsValidUsername] = useState(true);\n  const [username, setUsername] = useState(\"\");\n  const lastUsername = useRef(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [firstName, setFirstName] = useState(\"\");\n  const [lastName, setLastName] = useState(\"\");\n  const [instruments, setInstruments] = useState([]);\n  const [filteredInstruments, setFilteredInstruments] = useState([]);\n  const [knownInstruments, setKnownInstruments] = useState([]);\n  const [instQuery, setInstQuery] = useState(\"\");\n  const [cachedSearches, setCachedSearches] = useState({});\n  const [artistQueryResults, setArtistQueryResults] = useState([]);\n  const [artistQuery, setArtistQuery] = useState(\"\");\n  const [artists, setArtists] = useState([]);\n  const [pageIndex, setPageIndex] = useState(0);\n\n  async function checkUsername() {\n    if (username === lastUsername.current) return isValidUsername;\n    let response = await apiService.current.existingUser(username);\n    setIsValidUsername(response.ok);\n    lastUsername.current = username;\n    return response.ok;\n  }\n\n  useInterval(checkUsername, CHECK_USERNAME_DELAY);\n\n  async function userCredentials() {\n    if (password !== confirmPassword || password === \"\" || username === \"\") {\n      return;\n    }\n\n    let validUsername = await checkUsername();\n\n    if (!validUsername) {\n      return;\n    }\n\n    setPageIndex(pageIndex + 1);\n  }\n\n  function userNames() {\n    if (firstName.length === 0) {\n      return;\n    }\n\n    setPageIndex(pageIndex + 1);\n  }\n\n  function prevPage() {\n    setPageIndex(pageIndex - 1);\n  }\n\n  function getFilteredInstruments(query) {\n    return matchingPrefixIgnoreCase(query, instruments);\n  }\n\n  useEffect(() => {\n    setFilteredInstruments(getFilteredInstruments(instQuery));\n  }, [instQuery, instruments]);\n\n  function onInstrumentSelect(instrument) {\n    if (knownInstruments.includes(instrument.name)) return;\n    setKnownInstruments([...knownInstruments, instrument.name]);\n  }\n\n  async function getInstruments() {\n    let response = await apiService.current.getInstruments();\n    let json = await response.json();\n    setInstruments(json);\n  }\n\n  useEffect(() => getInstruments(), []);\n\n  function removeInstrument(instrument) {\n    setKnownInstruments(knownInstruments.filter(filteredInstrument => filteredInstrument !== instrument));\n  }\n\n  function instrumentsDone() {\n    setPageIndex(pageIndex + 1);\n  }\n\n  useInterval(() => {\n    let cached = cachedSearches[artistQuery];\n    getArtistsForQuery(artistQuery, cached ? cached.wantedCount : 10, { ...cachedSearches\n    });\n  }, ARTIST_SEARCH_DELAY);\n\n  async function getArtistsForQuery(query, wantedCount, cachedSearches) {\n    if (query.length <= MIN_ARTIST_SEARCH_LEN) return null;\n    let cached = cachedSearches[query];\n\n    if (cached && cached.wantedCount !== wantedCount) {\n      cached.wantedCount = wantedCount;\n      setCachedSearches(cachedSearches);\n    }\n\n    if (cached && cached.responses.length >= wantedCount) return;\n    if (cached && cached.page === cached.totalPages) return;\n    let page = cached ? cached.page + 1 : 1;\n    let response = await apiService.current.findArtists(query, page);\n    let json = await response.json();\n\n    if (!cached) {\n      cachedSearches[query] = {\n        \"page\": page,\n        \"totalPages\": json.totalPages,\n        \"responses\": json.responses,\n        \"wantedCount\": wantedCount\n      };\n      cached = cachedSearches[query];\n    } else {\n      cached.page = page;\n      cached.totalPages = json.totalPages;\n      cached.responses = [...cached.responses, json.responses];\n    }\n\n    if (cached.responses.lenth < wantedCount) {\n      getArtistsForQuery(query, wantedCount, cachedSearches);\n    } else {\n      setCachedSearches(cachedSearches);\n    }\n  }\n\n  function onArtistSelect(entry) {\n    if (artists.length >= 2) setIsValidInterests(true);\n    setArtists([...artists, entry.content]);\n  }\n\n  useEffect(() => {\n    let cached = cachedSearches[artistQuery];\n\n    if (!cached) {\n      setArtistQueryResults([]);\n      return;\n    }\n\n    setArtistQueryResults(cached.responses.slice(0, cached.wantedCount).map(response => {\n      return {\n        \"html\": /*#__PURE__*/_jsxDEV(\"div\", {\n          style: artistContainer,\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            style: artistImageStyle,\n            src: response.thumb\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: artistNameStyle,\n            children: response.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 21\n        }, this),\n        \"content\": response\n      };\n    }));\n  }, [artistQuery, cachedSearches]);\n\n  function moreEntries() {\n    let cached = cachedSearches[artistQuery];\n    if (!cached) return;\n    getArtistsForQuery(artistQuery, cached.wantedCount + 10, { ...cachedSearches\n    });\n  }\n\n  function removeArtist(removeEntry) {\n    setArtists(artists.filter(artist => artist.path !== removeEntry.path));\n  }\n\n  async function createAccount() {\n    if (artists.length < 3) {\n      setIsValidInterests(false);\n      return;\n    }\n\n    let locationPromise = new Promise((resolve, reject) => {\n      navigator.geolocation.getCurrentPosition(pos => resolve(pos), error => reject(error));\n    });\n    let location = await locationPromise;\n    let response = await apiService.current.signup({\n      \"username\": username,\n      \"password\": password,\n      \"firstName\": firstName,\n      \"lastName\": lastName,\n      \"location\": {\n        \"longitude\": location.coords.longitude.toString(),\n        \"latitude\": location.coords.latitude.toString()\n      },\n      \"musicInterests\": artists.map(artist => {\n        return {\n          \"name\": artist.name,\n          \"path\": artist.path\n        };\n      }),\n      \"instruments\": knownInstruments\n    });\n\n    if (response.ok) {\n      let json = await response.json();\n      setSessionToken(json.token);\n    } else {\n      let error = await response.json();\n\n      if (error.status === 400) {\n        setFailMessage(error.message);\n      } else {\n        console.log(error);\n      }\n    }\n  }\n\n  const pages = [/*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container-fluid g-0\",\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"jam-title-text\",\n      children: \"Sign Up\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(ErrorInputField, {\n      value: username,\n      onInput: setUsername,\n      label: \"Username: \",\n      type: \"text\",\n      isError: !isValidUsername || username.length === 0,\n      message: username.length === 0 ? \"Username is required\" : \"Username taken\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(InputField, {\n      value: password,\n      onInput: setPassword,\n      label: \"Password:\",\n      type: \"password\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(ErrorInputField, {\n      value: confirmPassword,\n      onInput: setConfirmPassword,\n      label: \"Confirm Password: \",\n      type: \"password\",\n      isError: password !== confirmPassword,\n      message: \"Passwords must match\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row g-0\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"jam-submit-button\",\n          onClick: userCredentials,\n          children: \"Next\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 261,\n    columnNumber: 13\n  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container-fluid g-0\",\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"jam-title-text\",\n      children: \"Sign Up\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(ErrorInputField, {\n      value: firstName,\n      onInput: setFirstName,\n      label: \"First Name: \",\n      type: \"text\",\n      isError: firstName.length === 0,\n      message: \"First name is required\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(InputField, {\n      value: lastName,\n      onInput: setLastName,\n      label: \"Last Name:\",\n      type: \"text\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row g-0\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"jam-submit-button\",\n          onClick: prevPage,\n          children: \"Back\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"jam-submit-button\",\n          onClick: userNames,\n          children: \"Next\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 290,\n    columnNumber: 13\n  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container-fluid g-0\",\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"jam-title-text\",\n      children: \"Sign Up\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(DropdownField, {\n      value: instQuery,\n      onInput: setInstQuery,\n      label: \"Add Known Instruments:\",\n      type: \"text\",\n      hasMore: false,\n      onSelect: onInstrumentSelect,\n      entries: filteredInstruments.map(inst => {\n        return {\n          name: inst,\n          html: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: inst\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 32\n          }, this)\n        };\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      style: instrumentsListStyle,\n      children: knownInstruments.map(instrument => /*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"removable-list-entry\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: instrument\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: e => removeInstrument(instrument),\n          children: \"x\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 29\n        }, this)]\n      }, instrument, true, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 25\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row g-0\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"jam-submit-button\",\n          onClick: prevPage,\n          children: \"Back\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"jam-submit-button\",\n          onClick: instrumentsDone,\n          children: \"Next\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 312,\n    columnNumber: 13\n  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container-fluid g-0\",\n    children: [!isValidInterests && /*#__PURE__*/_jsxDEV(Alert, {\n      style: alertStyle,\n      variant: \"danger\",\n      children: \"Enter at least 3 artists\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 39\n    }, this), failMessage.length > 0 && /*#__PURE__*/_jsxDEV(Alert, {\n      style: alertStyle,\n      variant: \"danger\",\n      children: failMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 44\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"jam-title-text\",\n      children: \"Sign Up\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(DropdownField, {\n      value: artistQuery,\n      onInput: setArtistQuery,\n      label: \"Add Favorite Artists:\",\n      type: \"text\",\n      hasMore: cachedSearches[artistQuery] && cachedSearches[artistQuery].page < cachedSearches[artistQuery].totalPages,\n      onMore: moreEntries,\n      onSelect: onArtistSelect,\n      entries: artistQueryResults\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      style: instrumentsListStyle,\n      children: artists.map(artist => /*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"removable-list-entry\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: artistContainer,\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            style: artistImageStyle,\n            src: artist.thumb\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: artistNameStyle,\n            children: artist.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            style: artistButtonStyle,\n            onClick: e => removeArtist(artist),\n            children: \"x\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 29\n        }, this)\n      }, artist.path, false, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 25\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row g-0\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"jam-submit-button\",\n          onClick: prevPage,\n          children: \"Back\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 371,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"jam-submit-button\",\n          onClick: createAccount,\n          children: \"Create Account\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 369,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 345,\n    columnNumber: 13\n  }, this)];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"d-flex justify-content-center align-items-center\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"jam-form\",\n      children: pages[pageIndex]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 384,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 383,\n    columnNumber: 9\n  }, this);\n};\n\n_s(SignUp, \"fOWwJeCp3faGFhbjJyRjpU7RhW4=\", false, function () {\n  return [useInterval, useInterval];\n});\n\n_c = SignUp;\nexport default SignUp;\n\nvar _c;\n\n$RefreshReg$(_c, \"SignUp\");","map":{"version":3,"sources":["/Users/soniajaiswal/IdeaProjects/JAM/jam-frontend/src/components/signup.js"],"names":["React","useEffect","useRef","useState","InputField","useInterval","ErrorInputField","DropdownField","Alert","CHECK_USERNAME_DELAY","ARTIST_SEARCH_DELAY","MIN_ARTIST_SEARCH_LEN","matchingPrefixIgnoreCase","prefix","entries","toLowerCase","filter","entry","compareLength","Math","min","length","substring","instrumentsListStyle","margin","padding","listStyleType","artistContainer","height","position","artistImageStyle","width","borderRadius","artistNameStyle","fontSize","top","left","artistButtonStyle","marginTop","marginRight","alertStyle","SignUp","props","setSessionToken","apiService","isValidInterests","setIsValidInterests","failMessage","setFailMessage","isValidUsername","setIsValidUsername","username","setUsername","lastUsername","password","setPassword","confirmPassword","setConfirmPassword","firstName","setFirstName","lastName","setLastName","instruments","setInstruments","filteredInstruments","setFilteredInstruments","knownInstruments","setKnownInstruments","instQuery","setInstQuery","cachedSearches","setCachedSearches","artistQueryResults","setArtistQueryResults","artistQuery","setArtistQuery","artists","setArtists","pageIndex","setPageIndex","checkUsername","current","response","existingUser","ok","userCredentials","validUsername","userNames","prevPage","getFilteredInstruments","query","onInstrumentSelect","instrument","includes","name","getInstruments","json","removeInstrument","filteredInstrument","instrumentsDone","cached","getArtistsForQuery","wantedCount","responses","page","totalPages","findArtists","lenth","onArtistSelect","content","slice","map","thumb","moreEntries","removeArtist","removeEntry","artist","path","createAccount","locationPromise","Promise","resolve","reject","navigator","geolocation","getCurrentPosition","pos","error","location","signup","coords","longitude","toString","latitude","token","status","message","console","log","pages","inst","html","e"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from 'react';\nimport '../App.css';\nimport InputField from '../util/inputField';\nimport useInterval from '../util/useInterval';\nimport ErrorInputField from '../util/errorInputField';\nimport DropdownField from '../util/dropdownField';\nimport { Alert } from 'react-bootstrap';\n\nconst CHECK_USERNAME_DELAY = 2000; // every 2 seconds\nconst ARTIST_SEARCH_DELAY = 1000; // every second\nconst MIN_ARTIST_SEARCH_LEN = 2;\n\nfunction matchingPrefixIgnoreCase(prefix, entries) {\n    prefix = prefix.toLowerCase();\n    return entries.filter(entry => {\n        const compareLength = Math.min(prefix.length, entry.length);\n        return prefix.substring(0, compareLength) === entry.substring(0, compareLength).toLowerCase();\n    });\n}\n\nconst instrumentsListStyle = {\n    margin: \"0px\",\n    padding: \"0px\",\n    listStyleType: \"none\"\n}\n\nconst artistContainer = {\n    height: \"60px\",\n    position: \"relative\"\n}\n\nconst artistImageStyle = {\n    width: \"60px\",\n    height: \"60px\",\n    borderRadius: \"3px\"\n}\n\nconst artistNameStyle = {\n    fontSize: \"18pt\",\n    position: \"absolute\",\n    top: \"15px\",\n    left: \"70px\"\n}\n\nconst artistButtonStyle = {\n    marginTop: \"18px\",\n    marginRight: \"-10px\"\n}\n\nconst alertStyle = {\n    top: '0'\n};\n\nconst SignUp = (props) => {\n    const setSessionToken = props.setSessionToken;\n    const apiService = props.apiService;\n    const [isValidInterests, setIsValidInterests] = useState(true); \n    const [failMessage, setFailMessage] = useState(\"\");\n\n    const [isValidUsername, setIsValidUsername] = useState(true);\n    const [username, setUsername] = useState(\"\");\n    const lastUsername = useRef(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [confirmPassword, setConfirmPassword] = useState(\"\");\n\n    const [firstName, setFirstName] = useState(\"\");\n    const [lastName, setLastName] = useState(\"\");\n\n    const [instruments, setInstruments] = useState([]);\n    const [filteredInstruments, setFilteredInstruments] = useState([]);\n    const [knownInstruments, setKnownInstruments] = useState([]);\n    const [instQuery, setInstQuery] = useState(\"\");\n\n    const [cachedSearches, setCachedSearches] = useState({});\n    const [artistQueryResults, setArtistQueryResults] = useState([]);\n    const [artistQuery, setArtistQuery] = useState(\"\");\n    const [artists, setArtists] = useState([]);\n\n    const [pageIndex, setPageIndex] = useState(0);\n\n    async function checkUsername() {\n        if (username === lastUsername.current) return isValidUsername;\n\n        let response = await apiService.current.existingUser(username);\n        setIsValidUsername(response.ok);\n        lastUsername.current = username;\n        return response.ok;\n    }\n\n    useInterval(checkUsername, CHECK_USERNAME_DELAY);\n\n    async function userCredentials() {\n        if (password !== confirmPassword || password === \"\" || username === \"\") {\n            return;\n        }\n\n        let validUsername = await checkUsername();\n        if (!validUsername) {\n            return;\n        }\n\n        setPageIndex(pageIndex + 1);\n    }\n\n    function userNames() {\n        if (firstName.length === 0) {\n            return;\n        }\n\n        setPageIndex(pageIndex + 1);\n    }\n\n    function prevPage() {\n        setPageIndex(pageIndex - 1);\n    }\n\n    function getFilteredInstruments(query) {\n        return matchingPrefixIgnoreCase(query, instruments);\n    }\n    useEffect(() => {\n        setFilteredInstruments(getFilteredInstruments(instQuery));\n    }, [instQuery, instruments]);\n\n    function onInstrumentSelect(instrument) {\n        if (knownInstruments.includes(instrument.name)) return;\n        setKnownInstruments([...knownInstruments, instrument.name]);\n    }\n\n    async function getInstruments() {\n        let response = await apiService.current.getInstruments();\n        let json = await response.json();\n        setInstruments(json);\n    }\n    useEffect(() => getInstruments(), []);\n\n    function removeInstrument(instrument) {\n        setKnownInstruments(knownInstruments.filter(filteredInstrument => filteredInstrument !== instrument));\n    }\n\n    function instrumentsDone() {\n        setPageIndex(pageIndex + 1);\n    }\n\n    useInterval(() => {\n        let cached = cachedSearches[artistQuery];\n        getArtistsForQuery(artistQuery, cached ? cached.wantedCount : 10, {...cachedSearches});\n    }, ARTIST_SEARCH_DELAY);\n\n\n    async function getArtistsForQuery(query, wantedCount, cachedSearches) {\n        if (query.length <= MIN_ARTIST_SEARCH_LEN) return null;\n\n        let cached = cachedSearches[query];\n\n        if (cached && cached.wantedCount !== wantedCount) {\n            cached.wantedCount = wantedCount;\n            setCachedSearches(cachedSearches);\n        }\n        if (cached && cached.responses.length >= wantedCount) return;\n        if (cached && cached.page === cached.totalPages) return;\n\n        let page = cached ? cached.page + 1 : 1;\n        let response = await apiService.current.findArtists(query, page);\n        let json = await response.json();\n        if (!cached) {\n            cachedSearches[query] = {\n                \"page\": page,\n                \"totalPages\": json.totalPages,\n                \"responses\": json.responses,\n                \"wantedCount\": wantedCount\n            };\n            cached = cachedSearches[query];\n        } else {\n            cached.page = page;\n            cached.totalPages = json.totalPages;\n            cached.responses = [...cached.responses, json.responses];\n        }\n\n        if (cached.responses.lenth < wantedCount) {\n            getArtistsForQuery(query, wantedCount, cachedSearches);\n        } else {\n            setCachedSearches(cachedSearches);\n        }\n    }\n\n    function onArtistSelect(entry) {\n        if (artists.length >= 2) setIsValidInterests(true);\n        setArtists([...artists, entry.content]);\n    }\n\n    useEffect(() => {\n        let cached = cachedSearches[artistQuery];\n        if (!cached) {\n            setArtistQueryResults([]);\n            return;\n        }\n\n        setArtistQueryResults(cached.responses.slice(0, cached.wantedCount).map(response => {\n            return {\n                \"html\": (\n                    <div style={artistContainer}>\n                        <img style={artistImageStyle} src={response.thumb}/>\n                        <div style={artistNameStyle}>{response.name}</div>\n                    </div>\n                    ),\n                \"content\": response\n            };\n        }));\n    }, [artistQuery, cachedSearches]);\n\n    function moreEntries() {\n        let cached = cachedSearches[artistQuery];\n        if (!cached) return;\n\n        getArtistsForQuery(artistQuery, cached.wantedCount + 10, {...cachedSearches});\n    }\n\n    function removeArtist(removeEntry) {\n        setArtists(artists.filter(artist => artist.path !== removeEntry.path));\n    }\n\n    async function createAccount() {\n        if (artists.length < 3) {\n            setIsValidInterests(false);\n            return;\n        }\n\n        let locationPromise = new Promise((resolve, reject) => {\n            navigator.geolocation.getCurrentPosition(pos => resolve(pos), error => reject(error));\n        });\n        let location = await locationPromise;\n        let response = await apiService.current.signup({\n            \"username\": username,\n            \"password\": password,\n            \"firstName\": firstName,\n            \"lastName\": lastName,\n            \"location\": {\n                \"longitude\": location.coords.longitude.toString(),\n                \"latitude\": location.coords.latitude.toString()\n            },\n            \"musicInterests\": artists.map(artist => {\n                return {\"name\": artist.name, \"path\": artist.path}\n            }),\n            \"instruments\": knownInstruments\n        });\n        if (response.ok) {\n            let json = await response.json();\n            setSessionToken(json.token);\n        } else {\n            let error = await response.json();\n            if (error.status === 400) {\n                setFailMessage(error.message);\n            } else {\n                console.log(error);\n            }\n        }\n    }\n\n    const pages = [\n        (\n            <div className=\"container-fluid g-0\">\n                <p className=\"jam-title-text\">Sign Up</p>\n                <ErrorInputField \n                    value={username} \n                    onInput={setUsername}\n                    label=\"Username: \" \n                    type=\"text\" \n                    isError={!isValidUsername || username.length === 0} \n                    message={username.length === 0 ? \"Username is required\" : \"Username taken\"}/>\n                <InputField value={password} onInput={setPassword} label=\"Password:\" type=\"password\" />\n                <ErrorInputField \n                    value={confirmPassword}\n                    onInput={setConfirmPassword}\n                    label=\"Confirm Password: \" \n                    type=\"password\" \n                    isError={password !== confirmPassword}\n                    message=\"Passwords must match\"/>\n                <div className=\"row g-0\">\n                    <div className=\"col-4\">\n                        {/* <button className=\"jam-submit-button disabled\" disabled>Back</button> */}\n                    </div>\n                    <div className=\"col-4\"></div>\n                    <div className=\"col-4\">\n                        <button className=\"jam-submit-button\" onClick={userCredentials}>Next</button>\n                    </div>  \n                </div>\n            </div> \n        ),\n        (\n            <div className=\"container-fluid g-0\">\n                <p className=\"jam-title-text\">Sign Up</p>\n                <ErrorInputField \n                    value={firstName}\n                    onInput={setFirstName}\n                    label=\"First Name: \" \n                    type=\"text\" \n                    isError={firstName.length === 0}\n                    message=\"First name is required\"/>\n                <InputField value={lastName} onInput={setLastName} label=\"Last Name:\" type=\"text\" />\n                <div className=\"row g-0\">\n                    <div className=\"col-4\">\n                        <button className=\"jam-submit-button\" onClick={prevPage}>Back</button>\n                    </div>\n                    <div className=\"col-4\"></div>\n                    <div className=\"col-4\">\n                        <button className=\"jam-submit-button\" onClick={userNames}>Next</button>\n                    </div>  \n                </div>\n            </div> \n        ),\n        (\n            <div className=\"container-fluid g-0\">\n                <p className=\"jam-title-text\">Sign Up</p>\n                <DropdownField \n                    value={instQuery}\n                    onInput={setInstQuery}\n                    label=\"Add Known Instruments:\" \n                    type=\"text\"\n                    hasMore={false}\n                    onSelect={onInstrumentSelect}\n                    entries = {filteredInstruments.map(inst => {return {\n                        name: inst, \n                        html: (<span>{inst}</span>)\n                    }})}/>\n                <ul style={instrumentsListStyle}>\n                    {knownInstruments.map(instrument => (\n                        <li className=\"removable-list-entry\" key={instrument}>\n                            <span>{instrument}</span>\n                            <button onClick={e => removeInstrument(instrument)}>x</button>\n                        </li>\n                    ))}\n                </ul>\n                <div className=\"row g-0\">\n                    <div className=\"col-4\">\n                        <button className=\"jam-submit-button\" onClick={prevPage}>Back</button>\n                    </div>\n                    <div className=\"col-4\"></div>\n                    <div className=\"col-4\">\n                        <button className=\"jam-submit-button\" onClick={instrumentsDone}>Next</button>\n                    </div>  \n                </div>\n            </div>\n        ),\n        (\n            <div className=\"container-fluid g-0\">\n                {!isValidInterests && <Alert style={alertStyle} variant=\"danger\">Enter at least 3 artists</Alert>}\n                {failMessage.length > 0 && <Alert style={alertStyle} variant=\"danger\">{failMessage}</Alert>}\n                <p className=\"jam-title-text\">Sign Up</p>\n                <DropdownField \n                    value={artistQuery}\n                    onInput={setArtistQuery}\n                    label=\"Add Favorite Artists:\" \n                    type=\"text\"\n                    hasMore={cachedSearches[artistQuery] && cachedSearches[artistQuery].page < cachedSearches[artistQuery].totalPages}\n                    onMore={moreEntries}\n                    onSelect={onArtistSelect}\n                    entries={artistQueryResults}/>\n                <ul style={instrumentsListStyle}>\n                    {artists.map(artist => (\n                        <li className=\"removable-list-entry\" key={artist.path}>\n                            <div style={artistContainer}>\n                                <img style={artistImageStyle} src={artist.thumb}/>\n                                <div style={artistNameStyle}>{artist.name}</div>\n                                <button style={artistButtonStyle} onClick={e => removeArtist(artist)}>x</button>\n                            </div>\n                        </li>\n                    ))}\n                </ul>\n                <div className=\"row g-0\">\n                    <div className=\"col-4\">\n                        <button className=\"jam-submit-button\" onClick={prevPage}>Back</button>\n                    </div>\n                    <div className=\"col-4\"></div>\n                    <div className=\"col-4\">\n                        <button className=\"jam-submit-button\" onClick={createAccount}>Create Account</button>\n                    </div>  \n                </div>\n            </div> \n        )\n    ];\n\n    return (\n        <div className=\"d-flex justify-content-center align-items-center\">\n            <div className=\"jam-form\">\n                {pages[pageIndex]}\n            </div>\n        </div>\n    );\n};\n\nexport default SignUp;"]},"metadata":{},"sourceType":"module"}